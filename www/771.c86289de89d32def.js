"use strict";(self.webpackChunkadmin_ui=self.webpackChunkadmin_ui||[]).push([[771],{5771:(G,_,l)=>{l.r(_),l.d(_,{CreateMasterReportModule:()=>O});var d=l(6814),g=l(5628),i=l(95),f=l(590),T=l(7398),e=l(4769),b=l(1521),h=l(788),C=l(2848),Z=l(3058),v=l(5597),u=l(6304);function R(t,n){1&t&&(e.TgZ(0,"p",32),e._uU(1," Report Name is required! "),e.qZA())}function x(t,n){if(1&t&&(e.TgZ(0,"ng-option",34),e._uU(1),e.qZA()),2&t){const o=n.$implicit;e.Q6J("value",o.name),e.xp6(1),e.Oqu(o.name)}}function M(t,n){if(1&t&&(e.TgZ(0,"ng-option",34),e._uU(1),e.qZA()),2&t){const o=n.$implicit;e.Q6J("value",o.name),e.xp6(1),e.Oqu(o.name)}}function N(t,n){if(1&t){const o=e.EpF();e.TgZ(0,"div",13)(1,"div",14)(2,"label",36),e._uU(3,"Select Table"),e.qZA(),e.TgZ(4,"ng-select",37),e.NdJ("change",function(){e.CHM(o);const a=e.oxw(2);return e.KtG(a.fetchColumns())}),e.YNc(5,M,2,2,"ng-option",29),e.qZA()()()}if(2&t){const o=e.oxw(2);e.xp6(5),e.Q6J("ngForOf",o.tables)}}function q(t,n){if(1&t&&(e._UZ(0,"input",41),e._uU(1)),2&t){const o=n.item,r=n.item$;e.MGl("id","item-",n.index,""),e.Q6J("checked",r.selected),e.xp6(1),e.hij(" ",o.name," ")}}function A(t,n){if(1&t&&(e.TgZ(0,"div",13)(1,"div",14)(2,"label",38),e._uU(3,"Select Column"),e.qZA(),e.TgZ(4,"ng-select",39),e.YNc(5,q,2,3,"ng-template",40),e.qZA()()()),2&t){const o=e.oxw(2);e.xp6(4),e.Q6J("items",o.columns)("multiple",!0)("selectableGroup",!0)("closeOnSelect",!1)}}function y(t,n){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,N,6,1,"div",35),e.YNc(2,A,6,4,"div",35),e.qZA()),2&t){const o=e.oxw();e.xp6(1),e.Q6J("ngIf",o.masterReportForm.get("database").value),e.xp6(1),e.Q6J("ngIf",o.masterReportForm.get("tableName").value)}}function J(t,n){if(1&t&&(e.TgZ(0,"ng-option",34),e._uU(1),e.qZA()),2&t){const o=n.$implicit;e.Q6J("value",o.name),e.xp6(1),e.Oqu(o.name)}}function F(t,n){if(1&t){const o=e.EpF();e.TgZ(0,"div",13)(1,"div",14)(2,"label",44),e._uU(3,"Select Table"),e.qZA(),e.TgZ(4,"ng-select",45),e.NdJ("change",function(){e.CHM(o);const a=e.oxw(2);return e.KtG(a.fetchColumns())}),e.YNc(5,J,2,2,"ng-option",29),e.qZA()()()}if(2&t){const o=e.oxw(2);e.xp6(5),e.Q6J("ngForOf",o.tables)}}function I(t,n){if(1&t&&(e.TgZ(0,"ng-option",34),e._uU(1),e.qZA()),2&t){const o=n.$implicit;e.Q6J("value",o.name),e.xp6(1),e.Oqu(o.name)}}function U(t,n){if(1&t){const o=e.EpF();e.TgZ(0,"div",46)(1,"div",47)(2,"label",48),e._uU(3,"Select Column"),e.qZA(),e.TgZ(4,"ng-select",49),e.NdJ("change",function(){e.CHM(o);const a=e.oxw(2);return e.KtG(a.fetchColumns())}),e.YNc(5,I,2,2,"ng-option",29),e.qZA()(),e.TgZ(6,"div",50)(7,"button",51),e.NdJ("click",function(){e.CHM(o);const a=e.oxw(2);return e.KtG(a.getQueryMultipleTables())}),e._UZ(8,"fa-icon",52),e.qZA()()()}if(2&t){const o=e.oxw(2);e.xp6(5),e.Q6J("ngForOf",o.columns),e.xp6(3),e.Q6J("icon",o.faRotate)}}function Q(t,n){if(1&t&&(e.TgZ(0,"ng-option",34),e._uU(1),e.qZA()),2&t){const o=n.$implicit;e.Q6J("value",o.table_name),e.xp6(1),e.hij("",o.table_name," ")}}function S(t,n){if(1&t&&(e.TgZ(0,"div",14)(1,"label",53),e._uU(2,"Join Table"),e.qZA(),e.TgZ(3,"ng-select",54),e.YNc(4,Q,2,2,"ng-option",29),e.qZA()()),2&t){const o=e.oxw(2);e.xp6(4),e.Q6J("ngForOf",o.joinTables)}}function k(t,n){if(1&t&&(e.TgZ(0,"ng-option",34),e._uU(1),e.qZA()),2&t){const o=n.$implicit;e.Q6J("value",o.column_name),e.xp6(1),e.hij("",o.column_name," ")}}function Y(t,n){if(1&t&&(e.TgZ(0,"div",46)(1,"div",47)(2,"label",55),e._uU(3,"Select Column"),e.qZA(),e.TgZ(4,"ng-select",56),e.YNc(5,k,2,2,"ng-option",29),e.qZA()(),e.TgZ(6,"div",50)(7,"button",57),e._UZ(8,"fa-icon",58),e.qZA()()()),2&t){const o=e.oxw(2);e.xp6(5),e.Q6J("ngForOf",o.joinTables),e.xp6(3),e.Q6J("icon",o.faPlus)}}function j(t,n){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,F,6,1,"div",35),e.YNc(2,U,9,2,"div",42),e.TgZ(3,"div",13),e.YNc(4,S,5,1,"div",43),e.qZA(),e.YNc(5,Y,9,2,"div",42),e.qZA()),2&t){const o=e.oxw();e.xp6(1),e.Q6J("ngIf",o.masterReportForm.value.database),e.xp6(1),e.Q6J("ngIf",o.masterReportForm.value.multiTable),e.xp6(2),e.Q6J("ngIf",o.masterReportForm.value.multiColumn),e.xp6(1),e.Q6J("ngIf",o.masterReportForm.value.multiColumn)}}const D=[{path:"",component:(()=>{var t;class n{constructor(r,a,s,c,m,p){this.fb=r,this.httpService=a,this.constant=s,this.dataService=c,this.router=m,this.storage=p,this.faPlus=f.r8p,this.faRotate=f.go9,this.columnGroups=[],this.databases=[],this.tables=[],this.columns=[],this.joinTables=[],this.isSingleTable=!0,this.errroMessage="",this.masterReportForm=this.fb.group({name:["",i.kI.required],database:["",i.kI.required],tableName:["",i.kI.required],multiTable:["",i.kI.required],joinTable:["",i.kI.required],queryType:["single",i.kI.required],columns:[[]],multiColumn:["",i.kI.required],joinColumn:["",i.kI.required]}),this.fetchDatabases()}addMoreColumn(){const r=this.fb.group({columns:["",i.kI.required]});this.columnGroups.push(r)}toggleTableType(r){this.isSingleTable="single"===r,this.masterReportForm.get("database").setValue("")}fetchDatabases(){this.getDBDetails("getOwners").subscribe(r=>this.databases=r)}fetchTables(){this.getDBDetails("getTables",{[this.constant.key_name]:this.masterReportForm.value.database}).subscribe(a=>this.tables=a)}fetchColumns(){this.getDBDetails("getColumns",{[this.constant.key_name]:this.masterReportForm.value.tableName||this.masterReportForm.value.multiTable}).subscribe(a=>this.columns=a)}getDBDetails(r,a={}){const s={...this.dataService.commonInputData(),[this.constant.key_requestType]:r,...a};return this.httpService.callApiServices(this.constant.serviceName_GETDBDETAILS,s).pipe((0,T.U)(m=>m.set.records))}createMasterReport(){const{name:r,tableName:a,columns:s}=this.masterReportForm.value,c=this.constant.serviceName_CREATEREPORT,m={...this.dataService.commonInputData(),[this.constant.key_name]:r,[this.constant.key_tableName]:a,[this.constant.key_queryType]:"select",[this.constant.key_columnName]:s.join(",")};this.httpService.callApiServices(c,m).subscribe({next:p=>{this.dataService.goToPage("generateMasterReport"),console.log(p)}})}getQueryMultipleTables(){const{multiTable:r,database:a,multiColumn:s}=this.masterReportForm.value,c=this.constant.serviceName_GETQUERYMULTIPLETABLES;let m={...this.dataService.commonInputData(),[this.constant.key_tableName]:r,[this.constant.key_ownerName]:a,[this.constant.key_columnName]:s};this.httpService.callApiServices(c,m).subscribe({next:p=>{"01"===p.responseParameter.opstatus&&setTimeout(()=>this.errroMessage=this.errroMessage=p.responseParameter.Result,2e3),this.joinTables=p.set.records,console.log(this.joinTables)}})}}return(t=n).\u0275fac=function(r){return new(r||t)(e.Y36(i.qu),e.Y36(b.c),e.Y36(h.$),e.Y36(C.D),e.Y36(g.F0),e.Y36(Z.n))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-create-master-report"]],decls:55,vars:6,consts:[[1,"main","bg-m"],[1,"right-main-column"],[1,"right-col-container","pad-b","full-width"],[1,"body-page-container","main-dashborad"],[1,"container-fluid"],[1,"row","no-gutters"],[1,"col-12"],[1,"row1"],[1,"col-12","col-sm-12","col-md-12","col-lg-12","col-xl-12"],[3,"formGroup"],[1,"card","mt-3"],[1,"card-header","bg-primary","text-white"],[1,"card-body","bg-light"],[1,"col-12","col-md-6","col-lg-6","col-xl-6"],[1,"ux-input"],["for","name"],[1,"mandatory"],["id","name","type","text","formControlName","name","placeholder","Enter Report Name","required",""],["class","text-danger",4,"ngIf"],[1,"col-12","col-md-12","col-lg-12","col-xl-12","mt-2"],[1,"d-flex","flex-row"],[1,"mr-3"],[1,"ux-selection","form-check"],["type","radio","id","table","name","queryType","formControlName","queryType","value","single",1,"form-check-input",3,"change"],["for","table",1,"form-check-label","p-0"],["type","radio","id","masterReport","name","queryType","formControlName","queryType","value","multiple",1,"form-check-input",3,"change"],["for","masterReport",1,"form-check-label","p-0"],["for","database",1,"align-self-center"],["labelForId","database","formControlName","database",3,"change"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["type","button",1,"ux-button","btn","btn-success",3,"click"],[1,"text-danger"],[1,"col-12","col-md-6","col-lg-6","col-xl-6","mt-4"],[3,"value"],["class","col-12 col-md-6 col-lg-6 col-xl-6",4,"ngIf"],["for","tableName",1,"align-self-center"],["labelForId","tableName","formControlName","tableName",3,"change"],["for","columns",1,"align-self-center"],["bindLabel","name","bindValue","name","formControlName","columns",3,"items","multiple","selectableGroup","closeOnSelect"],["ng-option-tmp",""],["type","checkbox",3,"id","checked"],["class","col-12 col-md-6 col-lg-6 col-xl-6 d-flex justify-content-between",4,"ngIf"],["class","ux-input",4,"ngIf"],["for","multiTable",1,"align-self-center"],["labelForId","multiTable","formControlName","multiTable",3,"change"],[1,"col-12","col-md-6","col-lg-6","col-xl-6","d-flex","justify-content-between"],[1,"ux-input","col-8","p-0"],["for","multiColumn",1,"align-self-center"],["labelForId","multiColumn","formControlName","multiColumn",3,"change"],[1,"col-2","align-self-center","px-0"],[1,"btn","bg-primary","rounded","d-flex",3,"click"],["title","Click to fetch table",3,"icon"],["for","joinTable",1,"align-self-center"],["labelForId","joinTable","formControlName","joinTable"],["for","joinColumn",1,"align-self-center"],["labelForId","joinColumn","formControlName","joinColumn"],[1,"btn","bg-primary","rounded"],["title","Click to Add More Columns",3,"icon"]],template:function(r,a){1&r&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"form",9)(10,"div",10)(11,"div",11),e._uU(12," Create Master Report "),e.qZA(),e.TgZ(13,"div",12)(14,"div",13)(15,"div",14)(16,"label",15),e._uU(17,"Report Name:"),e.TgZ(18,"span",16),e._uU(19,"*"),e.qZA()(),e._UZ(20,"input",17),e.YNc(21,R,2,0,"p",18),e.qZA()(),e.TgZ(22,"div",19)(23,"div",14)(24,"label"),e._uU(25,"Table Type:"),e.TgZ(26,"span",16),e._uU(27,"*"),e.qZA()(),e.TgZ(28,"div",20)(29,"div",21)(30,"div",22)(31,"input",23),e.NdJ("change",function(){return a.toggleTableType("single")}),e.qZA(),e.TgZ(32,"label",24),e._uU(33,"Single Table"),e.qZA()()(),e.TgZ(34,"div",21)(35,"div",22)(36,"input",25),e.NdJ("change",function(){return a.toggleTableType("multiple")}),e.qZA(),e.TgZ(37,"label",26),e._uU(38,"Multiple Table"),e.qZA()()()()()(),e.TgZ(39,"div",13)(40,"div",14)(41,"label",27),e._uU(42,"Get Databases "),e.TgZ(43,"span",16),e._uU(44,"*"),e.qZA()(),e.TgZ(45,"ng-select",28),e.NdJ("change",function(){return a.fetchTables()}),e.YNc(46,x,2,2,"ng-option",29),e.qZA()()(),e.YNc(47,y,3,2,"div",30),e.YNc(48,j,6,4,"div",30),e.TgZ(49,"div",13)(50,"button",31),e.NdJ("click",function(){return a.createMasterReport()}),e._uU(51," Save "),e.qZA(),e.TgZ(52,"p",32),e._uU(53),e.qZA()(),e._UZ(54,"div",33),e.qZA()()()()()()()()()()()()),2&r&&(e.xp6(9),e.Q6J("formGroup",a.masterReportForm),e.xp6(12),e.Q6J("ngIf",a.masterReportForm.controls.name.touched&&a.masterReportForm.controls.name.hasError("required")),e.xp6(25),e.Q6J("ngForOf",a.databases),e.xp6(1),e.Q6J("ngIf",a.isSingleTable),e.xp6(1),e.Q6J("ngIf",!a.isSingleTable),e.xp6(5),e.Oqu(a.errroMessage))},dependencies:[d.sg,d.O5,i._Y,i.Fj,i._,i.JJ,i.JL,i.Q7,i.sg,i.u,v.BN,u.w9,u.jq,u.ir],changeDetection:0}),n})()}];let E=(()=>{var t;class n{}return(t=n).\u0275fac=function(r){return new(r||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[g.Bz.forChild(D),g.Bz]}),n})(),O=(()=>{var t;class n{}return(t=n).\u0275fac=function(r){return new(r||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[d.ez,E,i.u5,i.UX,v.uH,u.A0]}),n})()}}]);